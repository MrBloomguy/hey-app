"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8916],{11438:(t,e,i)=>{i.d(e,{A:()=>h});var o=i(65723),s=i(90711),r=i(22155);let h=t=>{let{onChange:e,disabled:i}=t,h=(0,r.useId)();return(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsxs)("label",{className:"flex cursor-pointer items-center space-x-2 rounded-xl border border-gray-300 bg-white px-3 py-1 text-gray-700 shadow-sm outline-offset-4 dark:border-gray-700 dark:bg-gray-800 dark:text-white",htmlFor:h,children:[(0,o.jsx)(s.A,{className:"size-4"}),(0,o.jsx)("span",{children:"Choose File"})]}),(0,o.jsx)("input",{accept:".png, .jpg, .jpeg, .gif",className:"hidden",id:h,onChange:e,disabled:i,onClick:t=>{t.target.value=""},type:"file"})]})}},5360:(t,e,i)=>{i.d(e,{A:()=>g});var o=i(65723),s=i(35288),r=i(60416),h=i(36018),n=i(62876),a=i.n(n),c=i(22155),p=i(12005);class d extends c.Component{componentDidMount(){var t;this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),(null===(t=this.imageRef.current)||void 0===t?void 0:t.complete)&&this.onMediaLoad()}componentDidUpdate(t){t.zoom!==this.props.zoom&&this.recomputeCropPosition(),(this.props.cropSize.width!==t.cropSize.width||this.props.cropSize.height!==t.cropSize.height)&&this.computeSizes()}componentWillUnmount(){this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.cleanEvents(),this.clearScrollEvent()}onPinchMove(t){let e=d.getTouchPoint(t.touches[0]),i=d.getTouchPoint(t.touches[1]),o=(0,p.t9)(e,i);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(()=>{let t=(0,p.JV)(e,i),s=this.props.zoom*(t/this.lastPinchDistance);this.setNewZoom(s,o,{shouldUpdatePosition:!1}),this.lastPinchDistance=t})}onPinchStart(t){let e=d.getTouchPoint(t.touches[0]),i=d.getTouchPoint(t.touches[1]);this.lastPinchDistance=(0,p.JV)(e,i),this.onDragStart((0,p.t9)(e,i))}render(){let{borderSize:t,cropPositionPercent:{x:e,y:i},cropSize:s,image:r,zoom:n}=this.props,a=this.mediaSize.naturalWidth/this.mediaSize.naturalHeight<this.props.cropSize.width/this.props.cropSize.height;return(0,o.jsx)("div",{className:"rounded-lg",style:{height:s.height+2*t,overflow:"hidden",padding:t,width:s.width+2*t},children:(0,o.jsx)("div",{className:"relative",style:{height:s.height,width:s.width},children:(0,o.jsxs)("div",{className:(0,h.A)("reactEasyCrop_Container"),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:t=>this.containerRef=t,children:[r&&(0,o.jsx)("img",{alt:"",className:(0,h.A)("reactEasyCrop_Image",a?"reactEasyCrop_Cover_Horizontal":"reactEasyCrop_Cover_Vertical"),onLoad:this.onMediaLoad,ref:this.imageRef,src:r,style:{transform:"translate(".concat(e,"%, ").concat(i,"%) scale(").concat(n,")")}}),(0,o.jsx)("div",{className:(0,h.A)("border-2 border-gray-500","reactEasyCrop_CropArea"),style:{boxShadow:"0 0 0 ".concat(t,"px"),color:"#bbba",height:s.height,width:s.width}})]})})})}constructor(...t){var e;super(...t),e=this,this.cleanEvents=()=>{this.currentDoc.removeEventListener("mousemove",this.onMouseMove),this.currentDoc.removeEventListener("mouseup",this.onDragStopped),this.currentDoc.removeEventListener("touchmove",this.onTouchMove),this.currentDoc.removeEventListener("touchend",this.onDragStopped),this.currentDoc.removeEventListener("gesturemove",this.onGestureMove),this.currentDoc.removeEventListener("gestureend",this.onGestureEnd)},this.clearScrollEvent=()=>{this.containerRef&&this.containerRef.removeEventListener("wheel",this.onWheel),this.wheelTimer&&clearTimeout(this.wheelTimer)},this.computeSizes=()=>{if(this.imageRef.current&&this.containerRef){var t,e;let i=(null===(t=this.imageRef.current)||void 0===t?void 0:t.naturalWidth)||0,o=(null===(e=this.imageRef.current)||void 0===e?void 0:e.naturalHeight)||0,s=i/o,r=i/o<this.props.cropSize.width/this.props.cropSize.height?{height:this.props.cropSize.width/s,width:this.props.cropSize.width}:{height:this.props.cropSize.height,width:this.props.cropSize.height*s};this.mediaSize={...r,naturalHeight:o,naturalWidth:i};let h={height:this.props.cropSize.height,width:this.props.cropSize.width};return this.recomputeCropPosition(),h}},this.containerRef=null,this.currentDoc=document,this.currentWindow=window,this.dragStartCrop={x:0,y:0},this.dragStartPosition={x:0,y:0},this.emitCropData=()=>{let t=this.getCropData();if(!t)return;let{croppedAreaPixels:e}=t;this.props.onCropComplete&&this.props.onCropComplete(e)},this.gestureZoomStart=0,this.getAbsolutePosition=t=>({x:this.mediaSize.width*t.x/100,y:this.mediaSize.height*t.y/100}),this.getCropData=()=>{let t=this.getAbsolutePosition(this.props.cropPositionPercent),e=(0,p._3)(t,this.mediaSize,this.props.cropSize,this.props.zoom);return(0,p.yY)(e,this.props.cropSize,this.mediaSize,this.props.zoom)},this.getPercentPosition=t=>({x:t.x/this.mediaSize.width*100,y:t.y/this.mediaSize.height*100}),this.getPointOnContainer=t=>{var e;let{x:i,y:o}=t,s=null===(e=this.containerRef)||void 0===e?void 0:e.getBoundingClientRect();if(!s)throw Error("The Cropper is not mounted");return{x:s.width/2-(i-s.left),y:s.height/2-(o-s.top)}},this.getPointOnMedia=t=>{let{x:e,y:i}=t,o=this.getAbsolutePosition(this.props.cropPositionPercent),{zoom:s}=this.props;return{x:(e+o.x)/s,y:(i+o.y)/s}},this.imageRef=(0,c.createRef)(),this.isTouching=!1,this.lastPinchDistance=0,this.mediaSize={height:0,naturalHeight:0,naturalWidth:0,width:0},this.onDrag=t=>{let{x:e,y:i}=t;this.rafDragTimeout&&this.currentWindow.cancelAnimationFrame(this.rafDragTimeout),this.rafDragTimeout=this.currentWindow.requestAnimationFrame(()=>{if(void 0===e||void 0===i)return;let t=e-this.dragStartPosition.x,o=i-this.dragStartPosition.y,s={x:this.dragStartCrop.x+t,y:this.dragStartCrop.y+o},r=(0,p._3)(s,this.mediaSize,this.props.cropSize,this.props.zoom),h=this.getPercentPosition(r);this.props.onCropChange(h)})},this.onDragStart=t=>{let{x:e,y:i}=t;this.dragStartPosition={x:e,y:i},this.dragStartCrop={...this.getAbsolutePosition(this.props.cropPositionPercent)}},this.onDragStopped=()=>{this.isTouching=!1,this.cleanEvents(),this.emitCropData()},this.onGestureEnd=()=>{this.cleanEvents()},this.onGestureMove=t=>{if(t.preventDefault(),this.isTouching)return;let e=d.getMousePoint(t),i=this.gestureZoomStart-1+t.scale;this.setNewZoom(i,e,{shouldUpdatePosition:!0})},this.onGestureStart=t=>{t.preventDefault(),this.currentDoc.addEventListener("gesturechange",this.onGestureMove),this.currentDoc.addEventListener("gestureend",this.onGestureEnd),this.gestureZoomStart=this.props.zoom},this.onMediaLoad=()=>{let t=this.computeSizes();this.setNewZoom(1,{x:0,y:0}),t&&(this.emitCropData(),this.setInitialCrop())},this.onMouseDown=t=>{t.preventDefault(),this.currentDoc.addEventListener("mousemove",this.onMouseMove),this.currentDoc.addEventListener("mouseup",this.onDragStopped),this.onDragStart(d.getMousePoint(t))},this.onMouseMove=t=>this.onDrag(d.getMousePoint(t)),this.onTouchMove=t=>{t.preventDefault(),2===t.touches.length?this.onPinchMove(t):1===t.touches.length&&this.onDrag(d.getTouchPoint(t.touches[0]))},this.onTouchStart=t=>{this.isTouching=!0,this.currentDoc.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.currentDoc.addEventListener("touchend",this.onDragStopped),2===t.touches.length?this.onPinchStart(t):1===t.touches.length&&this.onDragStart(d.getTouchPoint(t.touches[0]))},this.onWheel=t=>{t.preventDefault();let e=d.getMousePoint(t),{spinY:i}=a()(t),o=this.props.zoom*this.props.zoomSpeed**-i;this.setNewZoom(o,e,{shouldUpdatePosition:!0}),this.state.hasWheelJustStarted||this.setState({hasWheelJustStarted:!0},()=>{}),this.wheelTimer&&clearTimeout(this.wheelTimer),this.wheelTimer=this.currentWindow.setTimeout(()=>this.setState({hasWheelJustStarted:!1},()=>{}),250)},this.preventZoomSafari=t=>t.preventDefault(),this.rafDragTimeout=null,this.rafPinchTimeout=null,this.recomputeCropPosition=()=>{let t=this.getAbsolutePosition(this.props.cropPositionPercent),e=(0,p._3)(t,this.mediaSize,this.props.cropSize,this.props.zoom),i=this.getPercentPosition(e);this.props.onCropChange(i),this.emitCropData()},this.setInitialCrop=()=>{this.props.onCropChange({x:0,y:0})},this.setNewZoom=function(t,i){let{shouldUpdatePosition:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.props.onZoomChange)return;let s=Math.max(1,2*(e.mediaSize.width/e.mediaSize.height<e.props.cropSize.width/e.props.cropSize.height?e.mediaSize.naturalWidth/e.props.targetSize.width:e.mediaSize.naturalHeight/e.props.targetSize.height)),r=(0,p.W9)(t,1,s);if(o){let t=i?e.getPointOnContainer(i):{x:0,y:0},o=e.getPointOnMedia(t),s={x:o.x*r-t.x,y:o.y*r-t.y},h=(0,p._3)(s,e.mediaSize,e.props.cropSize,r),n=e.getPercentPosition(h);e.props.onCropChange(n)}e.props.onZoomChange(r,s)},this.state={hasWheelJustStarted:!1},this.wheelTimer=null}}d.defaultProps={zoom:1,zoomSpeed:1},d.getMousePoint=t=>({x:Number(t.clientX),y:Number(t.clientY)}),d.getTouchPoint=t=>({x:Number(t.clientX),y:Number(t.clientY)});var u=i(65814);i(9576);var l=i(46281);let g=t=>{let{imageSrc:e,setCroppedAreaPixels:i,targetSize:h}=t,[n,a]=(0,c.useState)({x:0,y:0}),[p,g]=(0,c.useState)(1),[m,v]=(0,c.useState)(1),w=(0,c.useRef)(null),[S,f]=(0,c.useState)(h),{ref:x,width:P=S.width}=(0,l.A)(),z=h.width/h.height;return(0,c.useEffect)(()=>{let t=P-40;f({height:t/z,width:t})},[P,20,z]),(0,o.jsxs)("div",{ref:x,children:[(0,o.jsx)(d,{borderSize:20,cropPositionPercent:n,cropSize:S,image:e,onCropChange:a,onCropComplete:i,onZoomChange:(t,e)=>{g(t),v(e)},ref:w,targetSize:h,zoom:p,zoomSpeed:1.2}),(0,o.jsxs)("div",{className:"flex py-2",style:{width:S.width+40},children:[(0,o.jsx)(s.A,{className:"m-1 size-6"}),(0,o.jsx)(u.A,{className:"m-2 flex-grow",max:Math.log(m),min:0,onChange:t=>{var e;let i=Math.exp(Array.isArray(t)?t[0]:t);g(i),null===(e=w.current)||void 0===e||e.setNewZoom(i,null)},step:.001,value:Math.log(p)}),(0,o.jsx)(r.A,{className:"m-1 size-6"})]})]})}},12632:(t,e,i)=>{i.d(e,{A:()=>h,T:()=>r});var o=i(3556),s=i(98595);let r=t=>new Promise(e=>{let i=new FileReader;i.addEventListener("load",()=>e(i.result),!1),i.readAsDataURL(t)}),h=async t=>{let e=await new Promise(e=>t.toBlob(e)),i=new File([e],"cropped_image.png",{type:e.type}),r=await (0,o.A)(i,{exifOrientation:1,maxSizeMB:3,maxWidthOrHeight:2e3,useWebWorker:!0}),h=(await (0,s.h)(r)).uri;if(!h)throw Error("uploadToIPFS failed");return h}},12005:(t,e,i)=>{i.d(e,{JV:()=>h,W9:()=>o,_3:()=>r,nJ:()=>p,t9:()=>a,yY:()=>n});let o=(t,e,i)=>Math.min(Math.max(t,e),i),s=(t,e,i,s)=>{let r=e*s/2-i/2;return o(t,-r,r)},r=(t,e,i,o)=>({x:s(t.x,e.width,i.width,o),y:s(t.y,e.height,i.height,o)}),h=(t,e)=>Math.sqrt((t.y-e.y)**2+(t.x-e.x)**2),n=(t,e,i,o)=>{let s=i.naturalWidth/i.width,r=i.width/i.height<e.width/e.height?{height:i.naturalWidth*(e.height/e.width)/o,width:i.naturalWidth/o}:{height:i.naturalHeight/o,width:i.naturalHeight*(e.width/e.height)/o},h=-t.x*s/o,n=-t.y*s/o;return{croppedAreaPixels:{...r,x:h-r.width/2+i.naturalWidth/2,y:n-r.height/2+i.naturalHeight/2}}},a=(t,e)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),c=t=>new Promise((e,i)=>{let o=new Image;o.addEventListener("load",()=>e(o)),o.addEventListener("error",t=>i(t)),o.src=t}),p=async(t,e)=>{let i=await c(t),o=document.createElement("canvas"),s=o.getContext("2d");if(!s||!e)return null;o.width=i.width,o.height=i.height,s.drawImage(i,0,0);let r=s.getImageData(e.x,e.y,e.width,e.height);return o.width=e.width,o.height=e.height,s.putImageData(r,0,0),o}}}]);